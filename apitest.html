<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta http-equiv="X-UA-Compatible" content="ie=edge" />
        <title>News</title>
    </head>

    <!-- everything from here and below should be copied over to the HTML doc we are using -->
    <body>
        <form class="search" action="">
            <label for="">News</label>
            <!-- sample drop down menu, replace the value + text content to the key words/topics you want -->
            <select class="input">
                <option value="covid">covid</option>
                <option value="trump">trump</option>
                <option value="math">math</option>
                <option value="pollution">pollution</option>
              </select>
            <input type="submit" />
        </form>

        

    <!-- this is the list that is created with each input call  -->
    <!-- can change this to a carousel type thing (so only one article appears at a time) -->
    <div class="container">
        <ol class="carousel"></ol>
    </div>

    <script>
        // const searchFrom = document.querySelector('.search');
        // const input = document.querySelector('.input');
        const newsList = document.querySelector('.carousel');
        const apiKey = 'R67xub5MH8FbrUMnSODynY8ilBX9qEMK'
        const topics = ["fair trade", "economy", "technology", "infrastructure", "sustainability"];
        const urls = [];
        for (i = 0; i < 5; i++) {
            urls[i] = `https://api.nytimes.com/svc/search/v2/articlesearch.json?q=${topics[i]}&api-key=${apiKey}`
        }
        searchFrom.addEventListener('submit', retrieve);

        function retrieve(e) {
            
            newsList.innerHTML = ''
            e.preventDefault()
            for (i = 0; i < 5; i++) {
                fetch(urls[i]).then((res) => {
                    return res.json()
                }).then((data) => {
                    let li = document.createElement('li');
                    let h1 = document.createElement('h1');
                    let h2 = document.createElement('h2');
                    let a = document.createElement('a');
                    let p = document.createElement('p');

                    h1.textContent = data.response.docs[0].headline.main;
                    li.appendChild(h1);

                    a.setAttribute('href', data.response.docs[0].web_url);
                    a.setAttribute('target', '_blank');
                    a.textContent = "READ";
                    li.appendChild(a);
                        
                    p.textContent = data.response.docs[0].abstract; 
                    li.appendChild(p);

                    h2.textContent = data.response.docs[0].pub_date; 
                    li.appendChild(h2);

                    newsList.appendChild(li);

                }).catch((error)=> {
                    // for troubleshooting (inspect > console to see the error printed out)
                    console.log(error);
                })
            }
        }
    </script>


    </body>
</html>